diff -NurpP --minimal keepalived-1.1.19.a/configure keepalived-1.1.19.b/configure
--- keepalived-1.1.19.a/configure	2009-09-28 12:56:54.000000000 +0200
+++ keepalived-1.1.19.b/configure	2009-10-18 22:52:53.000000000 +0200
@@ -4227,7 +4227,6 @@ $as_echo "$as_me: error: Popt libraries 
 fi
 
 
-CPPFLAGS="$CPPFLAGS -I$kernelinc"
 { $as_echo "$as_me:$LINENO: checking for kernel version" >&5
 $as_echo_n "checking for kernel version... " >&6; }
 if test "$cross_compiling" = yes; then
@@ -4344,8 +4343,8 @@ $as_echo "$as_me: WARNING: Cannot determ
 IPVS_SUPPORT="_WITHOUT_LVS_"
 if test "$enable_lvs" != "no"; then
   if test "${ac_cv_header_net_ip_vs_h+set}" = set; then
-  { $as_echo "$as_me:$LINENO: checking for net/ip_vs.h" >&5
-$as_echo_n "checking for net/ip_vs.h... " >&6; }
+  { $as_echo "$as_me:$LINENO: checking for linux/ip_vs.h" >&5
+$as_echo_n "checking for linux/ip_vs.h... " >&6; }
 if test "${ac_cv_header_net_ip_vs_h+set}" = set; then
   $as_echo_n "(cached) " >&6
 fi
@@ -4353,8 +4352,8 @@ fi
 $as_echo "$ac_cv_header_net_ip_vs_h" >&6; }
 else
   # Is the header compilable?
-{ $as_echo "$as_me:$LINENO: checking net/ip_vs.h usability" >&5
-$as_echo_n "checking net/ip_vs.h usability... " >&6; }
+{ $as_echo "$as_me:$LINENO: checking linux/ip_vs.h usability" >&5
+$as_echo_n "checking linux/ip_vs.h usability... " >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -4362,7 +4361,7 @@ cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
 $ac_includes_default
-#include <net/ip_vs.h>
+#include <linux/ip_vs.h>
 _ACEOF
 rm -f conftest.$ac_objext
 if { (ac_try="$ac_compile"
@@ -4395,15 +4394,15 @@ rm -f core conftest.err conftest.$ac_obj
 $as_echo "$ac_header_compiler" >&6; }
 
 # Is the header present?
-{ $as_echo "$as_me:$LINENO: checking net/ip_vs.h presence" >&5
-$as_echo_n "checking net/ip_vs.h presence... " >&6; }
+{ $as_echo "$as_me:$LINENO: checking linux/ip_vs.h presence" >&5
+$as_echo_n "checking linux/ip_vs.h presence... " >&6; }
 cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
 cat confdefs.h >>conftest.$ac_ext
 cat >>conftest.$ac_ext <<_ACEOF
 /* end confdefs.h.  */
-#include <net/ip_vs.h>
+#include <linux/ip_vs.h>
 _ACEOF
 if { (ac_try="$ac_cpp conftest.$ac_ext"
 case "(($ac_try" in
@@ -4437,30 +4436,30 @@ $as_echo "$ac_header_preproc" >&6; }
 # So?  What about this header?
 case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in
   yes:no: )
-    { $as_echo "$as_me:$LINENO: WARNING: net/ip_vs.h: accepted by the compiler, rejected by the preprocessor!" >&5
-$as_echo "$as_me: WARNING: net/ip_vs.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
-    { $as_echo "$as_me:$LINENO: WARNING: net/ip_vs.h: proceeding with the compiler's result" >&5
-$as_echo "$as_me: WARNING: net/ip_vs.h: proceeding with the compiler's result" >&2;}
+    { $as_echo "$as_me:$LINENO: WARNING: linux/ip_vs.h: accepted by the compiler, rejected by the preprocessor!" >&5
+$as_echo "$as_me: WARNING: linux/ip_vs.h: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { $as_echo "$as_me:$LINENO: WARNING: linux/ip_vs.h: proceeding with the compiler's result" >&5
+$as_echo "$as_me: WARNING: linux/ip_vs.h: proceeding with the compiler's result" >&2;}
     ac_header_preproc=yes
     ;;
   no:yes:* )
-    { $as_echo "$as_me:$LINENO: WARNING: net/ip_vs.h: present but cannot be compiled" >&5
-$as_echo "$as_me: WARNING: net/ip_vs.h: present but cannot be compiled" >&2;}
-    { $as_echo "$as_me:$LINENO: WARNING: net/ip_vs.h:     check for missing prerequisite headers?" >&5
-$as_echo "$as_me: WARNING: net/ip_vs.h:     check for missing prerequisite headers?" >&2;}
-    { $as_echo "$as_me:$LINENO: WARNING: net/ip_vs.h: see the Autoconf documentation" >&5
-$as_echo "$as_me: WARNING: net/ip_vs.h: see the Autoconf documentation" >&2;}
-    { $as_echo "$as_me:$LINENO: WARNING: net/ip_vs.h:     section \"Present But Cannot Be Compiled\"" >&5
-$as_echo "$as_me: WARNING: net/ip_vs.h:     section \"Present But Cannot Be Compiled\"" >&2;}
-    { $as_echo "$as_me:$LINENO: WARNING: net/ip_vs.h: proceeding with the preprocessor's result" >&5
-$as_echo "$as_me: WARNING: net/ip_vs.h: proceeding with the preprocessor's result" >&2;}
-    { $as_echo "$as_me:$LINENO: WARNING: net/ip_vs.h: in the future, the compiler will take precedence" >&5
-$as_echo "$as_me: WARNING: net/ip_vs.h: in the future, the compiler will take precedence" >&2;}
+    { $as_echo "$as_me:$LINENO: WARNING: linux/ip_vs.h: present but cannot be compiled" >&5
+$as_echo "$as_me: WARNING: linux/ip_vs.h: present but cannot be compiled" >&2;}
+    { $as_echo "$as_me:$LINENO: WARNING: linux/ip_vs.h:     check for missing prerequisite headers?" >&5
+$as_echo "$as_me: WARNING: linux/ip_vs.h:     check for missing prerequisite headers?" >&2;}
+    { $as_echo "$as_me:$LINENO: WARNING: linux/ip_vs.h: see the Autoconf documentation" >&5
+$as_echo "$as_me: WARNING: linux/ip_vs.h: see the Autoconf documentation" >&2;}
+    { $as_echo "$as_me:$LINENO: WARNING: linux/ip_vs.h:     section \"Present But Cannot Be Compiled\"" >&5
+$as_echo "$as_me: WARNING: linux/ip_vs.h:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { $as_echo "$as_me:$LINENO: WARNING: linux/ip_vs.h: proceeding with the preprocessor's result" >&5
+$as_echo "$as_me: WARNING: linux/ip_vs.h: proceeding with the preprocessor's result" >&2;}
+    { $as_echo "$as_me:$LINENO: WARNING: linux/ip_vs.h: in the future, the compiler will take precedence" >&5
+$as_echo "$as_me: WARNING: linux/ip_vs.h: in the future, the compiler will take precedence" >&2;}
 
     ;;
 esac
-{ $as_echo "$as_me:$LINENO: checking for net/ip_vs.h" >&5
-$as_echo_n "checking for net/ip_vs.h... " >&6; }
+{ $as_echo "$as_me:$LINENO: checking for linux/ip_vs.h" >&5
+$as_echo_n "checking for linux/ip_vs.h... " >&6; }
 if test "${ac_cv_header_net_ip_vs_h+set}" = set; then
   $as_echo_n "(cached) " >&6
 else
diff -NurpP --minimal keepalived-1.1.19.a/configure.in keepalived-1.1.19.b/configure.in
--- keepalived-1.1.19.a/configure.in	2009-09-28 12:56:54.000000000 +0200
+++ keepalived-1.1.19.b/configure.in	2009-10-18 23:00:33.000000000 +0200
@@ -51,7 +51,7 @@ AC_CHECK_LIB(ssl, SSL_CTX_new,,AC_MSG_ER
 AC_CHECK_LIB(popt, poptGetContext,,AC_MSG_ERROR([Popt libraries is required]))
 
 dnl ----[ Kernel version check ]----
-CPPFLAGS="$CPPFLAGS -I$kernelinc"
+dnl CPPFLAGS="$CPPFLAGS -I$kernelinc"
 AC_MSG_CHECKING([for kernel version])
 AC_TRY_RUN([
     #include <stdlib.h>
@@ -116,7 +116,7 @@ AC_SUBST(KERN)
 dnl ----[ Checks for LVS and VRRP support ]----
 IPVS_SUPPORT="_WITHOUT_LVS_"
 if test "$enable_lvs" != "no"; then
-  AC_CHECK_HEADER([net/ip_vs.h],
+  AC_CHECK_HEADER([linux/ip_vs.h],
     [IPVS_SUPPORT="_WITH_LVS_"],
     [
       IPVS_SUPPORT="_WITHOUT_LVS_"
diff -NurpP --minimal keepalived-1.1.19.a/keepalived/include/check_data.h keepalived-1.1.19.b/keepalived/include/check_data.h
--- keepalived-1.1.19.a/keepalived/include/check_data.h	2009-09-28 13:31:07.000000000 +0200
+++ keepalived-1.1.19.b/keepalived/include/check_data.h	2009-10-18 23:04:13.000000000 +0200
@@ -39,7 +39,7 @@
 #else
 #define SCHED_MAX_LENGTH IP_VS_SCHEDNAME_MAXLEN
 #endif
-#include <net/ip_vs.h>
+#include <linux/ip_vs.h>
 #else
 #define SCHED_MAX_LENGTH   1
 #endif
diff -NurpP --minimal keepalived-1.1.19.a/keepalived/include/ipvswrapper.h keepalived-1.1.19.b/keepalived/include/ipvswrapper.h
--- keepalived-1.1.19.a/keepalived/include/ipvswrapper.h	2009-09-28 13:05:16.000000000 +0200
+++ keepalived-1.1.19.b/keepalived/include/ipvswrapper.h	2009-10-18 23:03:04.000000000 +0200
@@ -46,7 +46,7 @@
 #elif _KRNL_2_6_
   #include "../libipvs-2.6/libipvs.h"
 #endif
-  #include <net/ip_vs.h>
+  #include <linux/ip_vs.h>
 #endif
 
 #ifndef IP_VS_TEMPLATE_TIMEOUT
diff -NurpP --minimal keepalived-1.1.19.a/keepalived/libipvs-2.4/libipvs.h keepalived-1.1.19.b/keepalived/libipvs-2.4/libipvs.h
--- keepalived-1.1.19.a/keepalived/libipvs-2.4/libipvs.h	2009-09-28 12:56:54.000000000 +0200
+++ keepalived-1.1.19.b/keepalived/libipvs-2.4/libipvs.h	2009-10-18 23:05:54.000000000 +0200
@@ -10,7 +10,7 @@
 #ifndef _LIBIPVS_H
 #define _LIBIPVS_H
 
-#include <net/ip_vs.h>
+#include <linux/ip_vs.h>
 
 /*
  * The default IPVS_SVC_PERSISTENT_TIMEOUT is a little larger than average
diff -NurpP --minimal keepalived-1.1.19.a/keepalived/libipvs-2.6/libipvs.h keepalived-1.1.19.b/keepalived/libipvs-2.6/libipvs.h
--- keepalived-1.1.19.a/keepalived/libipvs-2.6/libipvs.h	2009-09-28 12:56:54.000000000 +0200
+++ keepalived-1.1.19.b/keepalived/libipvs-2.6/libipvs.h	2009-10-18 23:05:04.000000000 +0200
@@ -10,7 +10,7 @@
 #ifndef _LIBIPVS_H
 #define _LIBIPVS_H
 
-#include <net/ip_vs.h>
+#include <linux/ip_vs.h>
 
 #define MINIMUM_IPVS_VERSION_MAJOR      1
 #define MINIMUM_IPVS_VERSION_MINOR      1
